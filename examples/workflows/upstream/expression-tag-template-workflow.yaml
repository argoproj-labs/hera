apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: expression-tag-template-
  annotations:
    workflows.argoproj.io/version: '>= 3.1.0'
  labels:
    workflows.argoproj.io/test: 'true'
spec:
  entrypoint: main
  templates:
  - name: main
    dag:
      tasks:
      - name: task-0
        template: pod-0
        withParam: '{{=toJson(filter([1, 3], {# > 1}))}}'
        arguments:
          parameters:
          - name: foo
            value: '{{=item}}'
  - name: pod-0
    container:
      image: argoproj/argosay:v2
      args:
      - echo
      - |
        hello {{=asInt(inputs.parameters.foo) * 10}} @ {{=sprig.date('2006', workflow.creationTimestamp)}}
      - /output
    inputs:
      parameters:
      - name: foo
    outputs:
      parameters:
      - name: output
        valueFrom:
          path: /output
