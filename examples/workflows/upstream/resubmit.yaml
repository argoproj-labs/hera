apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: resubmit-
spec:
  entrypoint: rand-fail-dag
  templates:
  - name: rand-fail-dag
    dag:
      tasks:
      - name: A
        template: random-fail
      - name: B
        template: rand-fail-steps
      - name: C
        depends: B
        template: random-fail
      - name: D
        depends: A && B
        template: random-fail
  - name: rand-fail-steps
    steps:
    - - name: randfail1a
        template: random-fail
      - name: randfail1b
        template: random-fail
    - - name: randfail2a
        template: random-fail
      - name: randfail2b
        template: random-fail
      - name: randfail2c
        template: random-fail
      - name: randfail2d
        template: random-fail
  - name: random-fail
    container:
      image: python:alpine3.6
      args:
      - import random; import sys; exit_code = random.choice([0, 0, 1]); print('exiting
        with code {}'.format(exit_code)); sys.exit(exit_code)
      command:
      - python
      - -c
