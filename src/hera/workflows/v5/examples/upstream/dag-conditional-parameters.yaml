apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  annotations:
    workflows.argoproj.io/description: 'Conditional parameters provide a way to choose
      the output parameters based on expression.


      In this example DAG template has two task which will run conditionally based
      on `when`.


      Based on this condition one of task may not execute. The template''s output
      parameter will be set to the

      executed taks''s output result.

      '
    workflows.argoproj.io/version: '>= 3.1.0'
  generateName: dag-conditional-parameter-
  labels:
    workflows.argoproj.io/test: 'true'
spec:
  entrypoint: main
  templates:
  - dag:
      tasks:
      - name: flip-coin
        template: flip-coin
      - depends: flip-coin
        name: heads
        template: heads
        when: '{{tasks.flip-coin.outputs.result}} == heads'
      - depends: flip-coin
        name: tails
        template: tails
        when: '{{tasks.flip-coin.outputs.result}} == tails'
    name: main
    outputs:
      parameters:
      - name: stepresult
        valueFrom:
          expression: 'tasks[''flip-coin''].outputs.result == ''heads'' ? tasks.heads.outputs.result
            : tasks.tails.outputs.result'
  - name: flip-coin
    script:
      command:
      - python
      image: python:alpine3.6
      source: 'import random

        print("heads" if random.randint(0,1) == 0 else "tails")

        '
  - name: heads
    script:
      command:
      - python
      image: python:alpine3.6
      source: 'print("heads")

        '
  - name: tails
    script:
      command:
      - python
      image: python:alpine3.6
      source: 'print("tails")

        '
